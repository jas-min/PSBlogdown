---
title: Threat and Race
author: 
- admin
date: '2020-08-28'
slug: threat-and-race
categories:
  - R
tags:
  - R Markdown
  - plot
  - ANOVA
  - time
subtitle: ''
summary: ''
authors: []
lastmod: '2020-08-28T16:00:15-07:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



<div id="threat-and-race" class="section level1">
<h1>Threat and Race</h1>
<p>There has always been a debate between the links of fatal police shootings and victims. There has even been insinuations that race has an effect on the threatening nature of these individuals. This topic often sparks outrage within the black and POC communities and within law enforcement.</p>
<p>I’m going to try to explore this sensitive topic and try to make some inferential findings.</p>
</div>
<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>The dataset can be found <a href="https://github.com/washingtonpost/data-police-shootings">here</a>.</p>
<p>We have three variables to look at: “attack”, “other”, and “undetermined”. Attack constitutes as the individual was reported to have posed immediate threat to the officer. “Other” is every other level of threat and “undetermined” is for any circumstance that through the vetting process, threat level could not be determined.
Keep in mind how the level of threat is determined, as explained in the home page.</p>
<p>Let’s look at the visualization of the raw numbers/counts. Figure 1 below shows the level of reported threat by race.</p>
<pre class="r"><code>shootings %&gt;%
  mutate(count = 1) %&gt;%
  ggplot() +
  geom_bar(mapping = aes(x = threat_level, fill = race), position = &quot;dodge&quot;) +
  facet_wrap(~threat_level, scales = &quot;free&quot;) + 
  ggtitle(&quot;Raw Amounts of Threat Level&quot;) +
  xlab(&quot;Threat Level&quot;) +
  ylab(&quot;Count&quot;)</code></pre>
<p><img src="/post/2020-08-28-threat-and-race.en_files/figure-html/unnamed-chunk-1-1.png" width="672" />
Figure 1.
<em>Amount of Fatal Police Shootings by Race since 2015</em></p>
<p>All three graphs look identical. The only visual difference is the volume of the counts. I think in this case, looking at the proportions will be more inferenital.</p>
<pre class="r"><code>r.proportion &lt;- shootings %&gt;%
  mutate(count = 1) %&gt;%
  mutate(year = year(date)) %&gt;%
  aggregate(count ~ threat_level + race + year, data = ., sum) %&gt;%
  filter(threat_level == &quot;attack&quot;) %&gt;%
  group_by(year) %&gt;%
  mutate(race.proportion = count / sum(count))
r.proportion %&gt;%
  ggplot() +
  geom_boxplot(mapping = aes(x = race, y = race.proportion), fill = &quot;lavender&quot;) +
  geom_point(mapping = aes(x = race, y = race.proportion, color = year)) +
  ggtitle(&quot;Proportion of Race with &#39;attack&#39; Threat Level&quot;) + xlab(&quot;Race&quot;) +
  ylab(&quot;Proportion&quot;) + theme_bw()</code></pre>
<p><img src="/post/2020-08-28-threat-and-race.en_files/figure-html/unnamed-chunk-2-1.png" width="672" />
Figure 2.
<em>Box plot and distribution of the proportions of victims who are recorded to have posed a threat to an officer’s life by race from 2015 to current.</em></p>
<pre class="r"><code>r.proportion %&gt;%
  lm(formula = race.proportion ~ race, data = .) -&gt; model

summary(model)
## 
## Call:
## lm(formula = race.proportion ~ race, data = .)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.092653 -0.004648 -0.000999  0.011827  0.183269 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       0.014002   0.018970   0.738 0.465378    
## raceBlack         0.227499   0.026828   8.480 5.26e-10 ***
## raceHispanic      0.133036   0.026828   4.959 1.82e-05 ***
## raceNative       -0.001813   0.026828  -0.068 0.946506    
## raceNot Recorded  0.105896   0.026828   3.947 0.000364 ***
## raceOther        -0.005536   0.026828  -0.206 0.837706    
## raceWhite         0.442904   0.026828  16.509  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04647 on 35 degrees of freedom
## Multiple R-squared:  0.9273, Adjusted R-squared:  0.9148 
## F-statistic:  74.4 on 6 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>ANOVA.threat = aov(model)

# Tukey test to study each pair of treatment :
TUKEY &lt;- TukeyHSD(x=ANOVA.threat, &#39;race&#39;, conf.level=0.95, ordered = TRUE)
# Tuckey test representation :
plot(TUKEY , las=1 , col=&quot;brown&quot;)</code></pre>
<p><img src="/post/2020-08-28-threat-and-race.en_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>TUKEY
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
##     factor levels have been ordered
## 
## Fit: aov(formula = model)
## 
## $race
##                              diff         lwr        upr     p adj
## Native-Other          0.003723252 -0.08014022 0.08758673 0.9999993
## Asian-Other           0.005536265 -0.07832721 0.08939974 0.9999925
## Not Recorded-Other    0.111432473  0.02756900 0.19529595 0.0034425
## Hispanic-Other        0.138572099  0.05470863 0.22243557 0.0001832
## Black-Other           0.233035326  0.14917185 0.31689880 0.0000000
## White-Other           0.448440663  0.36457719 0.53230414 0.0000000
## Asian-Native          0.001813012 -0.08205046 0.08567649 1.0000000
## Not Recorded-Native   0.107709221  0.02384575 0.19157269 0.0050606
## Hispanic-Native       0.134848847  0.05098537 0.21871232 0.0002764
## Black-Native          0.229312074  0.14544860 0.31317555 0.0000000
## White-Native          0.444717410  0.36085394 0.52858088 0.0000000
## Not Recorded-Asian    0.105896208  0.02203274 0.18975968 0.0060919
## Hispanic-Asian        0.133035834  0.04917236 0.21689931 0.0003375
## Black-Asian           0.227499061  0.14363559 0.31136253 0.0000000
## White-Asian           0.442904398  0.35904093 0.52676787 0.0000000
## Hispanic-Not Recorded 0.027139626 -0.05672385 0.11100310 0.9478976
## Black-Not Recorded    0.121602853  0.03773938 0.20546633 0.0011716
## White-Not Recorded    0.337008190  0.25314472 0.42087166 0.0000000
## Black-Hispanic        0.094463227  0.01059975 0.17832670 0.0188790
## White-Hispanic        0.309868564  0.22600509 0.39373204 0.0000000
## White-Black           0.215405337  0.13154186 0.29926881 0.0000000</code></pre>
<pre class="r"><code># I need to group the treatments that are not different each other together.
generate_label_df &lt;- function(TUKEY, variable){
 
     # Extract labels and factor levels from Tukey post-hoc 
     levels &lt;- TUKEY[[variable]][,4]
     Tukey.labels &lt;- data.frame(multcompLetters(levels)[&#39;Letters&#39;])
     
     #I need to put the labels in the same order as in the boxplot :
     Tukey.labels$treatment=rownames(Tukey.labels)
     Tukey.labels=Tukey.labels[order(Tukey.labels$treatment) , ]
     return(Tukey.labels)
     }
 
# Apply the function on my dataset
LABELS &lt;- generate_label_df(TUKEY , &quot;race&quot;)
 
 
# A panel of colors to draw each group with the same color :
my_colors &lt;- c( 
  rgb(143,199,74,maxColorValue = 255),
  rgb(242,104,34,maxColorValue = 255), 
  rgb(111,145,202,maxColorValue = 255),
  rgb(151,105,102,maxColorValue = 255)
  )
 
# Draw the basic boxplot
a &lt;- boxplot(r.proportion$race.proportion ~ r.proportion$race, ylim=c(min(r.proportion$race.proportion) , 1.1*max(r.proportion$race.proportion)) , col=my_colors[as.numeric(LABELS[,1])] , ylab=&quot;value&quot; , main=&quot;&quot;)
## Warning in boxplot.default(split(mf[[response]], mf[-response], drop = drop, :
## NAs introduced by coercion


# I want to write the letter over each box. Over is how high I want to write it.
over &lt;- 0.1*max( a$stats[nrow(a$stats),] )
 
#Add the labels
text( c(1:nlevels(r.proportion$race)) , a$stats[nrow(a$stats),]+over , LABELS[,1]  , col  = my_colors[as.numeric(LABELS[,1])] )
## Warning in text.default(c(1:nlevels(r.proportion$race)),
## a$stats[nrow(a$stats), : NAs introduced by coercion</code></pre>
<p><img src="/post/2020-08-28-threat-and-race.en_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
